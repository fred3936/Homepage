---
title: "Lab_5"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

``` {r message=FALSE}
# Load required packages
library(tidyverse)
library(knitr)

# Read in the data
titanic <- read_csv("https://raw.githubusercontent.com/nt246/NTRES-6100-data-science/master/datasets/Titanic.csv")

# Let's look at the top 5 lines of the dataset
head(titanic, n = 5) %>%
  kable()
```

```{r message=FALSE}
notes <- read_csv("https://raw.githubusercontent.com/nt246/NTRES-6100-data-science/master/datasets/Notes.csv")
kable(notes)
```

<br>
Question 1.1 How many of them do we have information for in this dataset? 
```{r message=FALSE}
nrow(titanic)
```
<br>

Question 1.2 Of the people we have data for, how many of them survived and how many did not?
```{r message=FALSE}
myTable <- table(titanic$Survived)
myTable 
prop.table(myTable)

table(factor(titanic$Survived,  labels=c("died","survived")))

prop.table(table(factor(titanic$Survived,  labels=c("died","survived"))))
```
```{r}
titanic %>%
  mutate(survived = ifelse(Survived==0, "no", "yes"))%>%
  count(survived)%>%
  mutate(percentage = round(n/nrow(titanic)*100,2))
```
<br>
## question, what's the difference with or without kable()?

<br>

```{r message=FALSE}
# number of passengers surviving vs. dying
survived_count <- titanic %>%
  mutate(survived = ifelse(Survived==0, "no", "yes")) %>%
  count(survived) %>%
  mutate(percentage = round(n/nrow(titanic)*100,2))
kable(survived_count)
```

<br>

```{r message=FALSE}
# plotting
titanic %>%
  mutate(survived = ifelse(Survived==0, "no", "yes")) %>%
  ggplot(aes(x = survived)) +
  geom_bar(aes(fill = survived)) +
  geom_label(data = survived_count, aes(label=str_c(percentage, "%"), y=n/2)) +
  coord_flip()
```
<br>
## Note: str_c() is used to add the percentage sign

Question 2. How many passengers on the Titanic were males and how many were females? What do you find when you break it down by ticket class?


